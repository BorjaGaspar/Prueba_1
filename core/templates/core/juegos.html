{% extends 'core/base_private.html' %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold text-dark" id="titulo-seccion">Sala de Terapia</h2>
    
    <button id="btn-volver" class="btn btn-outline-secondary d-none" onclick="irAtras()">
        <i class="bi bi-arrow-left me-2"></i> Volver
    </button>
</div>

<div id="pantalla-inicio" class="row animate__animated animate__fadeIn">
    <div class="col-md-6 mb-4">
        <div class="card h-100 border-0 shadow-sm p-4 bg-light text-muted" style="opacity: 0.7;">
            <div class="card-body text-center d-flex flex-column justify-content-center align-items-center">
                <div class="bg-white rounded-circle p-4 mb-3 shadow-sm">
                    <i class="bi bi-stars display-4 text-secondary"></i>
                </div>
                <h3 class="fw-bold">Actividades Sugeridas</h3>
                <p>Tu rutina personalizada de hoy.</p>
                <button class="btn btn-secondary rounded-pill px-4 mt-3" disabled>
                    <i class="bi bi-lock-fill me-2"></i> Próximamente
                </button>
            </div>
        </div>
    </div>

    <div class="col-md-6 mb-4">
        <div class="card h-100 border-0 shadow-sm p-4 bg-white border-bottom border-5 border-success cursor-pointer transform-hover" onclick="mostrarCategorias()">
            <div class="card-body text-center d-flex flex-column justify-content-center align-items-center">
                <div class="bg-success-subtle rounded-circle p-4 mb-3">
                    <i class="bi bi-grid-fill display-4 text-success"></i>
                </div>
                <h3 class="fw-bold text-dark">Seleccionar Actividades</h3>
                <p class="text-muted">Explora el catálogo completo de ejercicios.</p>
                <button class="btn btn-success rounded-pill px-4 mt-3">
                    Entrar <i class="bi bi-arrow-right ms-2"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<div id="pantalla-categorias" class="row d-none animate__animated animate__fadeIn">
    <div class="col-md-4 mb-4">
        <div class="card border-0 shadow-sm h-100 hover-elevate" onclick="mostrarJuegos('Atención')">
            <div class="card-body p-4 text-center">
                <i class="bi bi-eye-fill display-1 text-primary mb-3"></i>
                <h4 class="fw-bold">Atención</h4>
                <p class="text-muted small">Ejercicios de concentración y enfoque visual.</p>
            </div>
        </div>
    </div>

    <div class="col-md-4 mb-4">
        <div class="card border-0 shadow-sm h-100 hover-elevate" onclick="mostrarJuegos('Lenguaje')">
            <div class="card-body p-4 text-center">
                <i class="bi bi-chat-quote-fill display-1 text-warning mb-3"></i>
                <h4 class="fw-bold">Lenguaje</h4>
                <p class="text-muted small">Vocabulario, comprensión y fluidez verbal.</p>
            </div>
        </div>
    </div>

    <div class="col-md-4 mb-4">
        <div class="card border-0 shadow-sm h-100 hover-elevate" onclick="mostrarJuegos('Motor')">
            <div class="card-body p-4 text-center">
                <i class="bi bi-hand-index-thumb-fill display-1 text-danger mb-3"></i>
                <h4 class="fw-bold">Motor</h4>
                <p class="text-muted small">Coordinación, precisión y tiempos de reacción.</p>
            </div>
        </div>
    </div>
</div>

<div id="pantalla-lista-juegos" class="d-none animate__animated animate__fadeIn">
    <h4 class="mb-4 text-muted">Ejercicios disponibles de <span id="nombre-categoria" class="fw-bold text-dark">--</span>:</h4>
    
    <div id="lista-juegos-comunes" class="row">
        {% for i in "123" %}
        <div class="col-md-4 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body p-5 text-center bg-light rounded">
                    <i class="bi bi-puzzle display-4 text-secondary opacity-50 mb-3"></i>
                    <h5 class="fw-bold">Juego {{ i }} <span class="nombre-cat-dinamico"></span></h5>
                    <button class="btn btn-sm btn-outline-dark mt-3" disabled>Disponible pronto</button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div id="lista-juegos-atencion" class="row d-none">
        <div class="col-md-4 mb-4">
            <div class="card border-0 shadow-sm h-100 transform-hover">
                <div class="card-body p-4 text-center bg-white rounded border-top border-5 border-warning">
                    <div class="mb-3">
                        <i class="bi bi-search display-4 text-warning"></i>
                    </div>
                    <h5 class="fw-bold">Encuentra la Letra</h5>
                    <p class="text-muted small">Atención Selectiva</p>
                    
                    <a href="{% url 'jugar_encuentra_letra' %}" class="btn btn-outline-warning rounded-pill px-4 w-100 mt-2 text-dark">
                        <i class="bi bi-play-fill me-2"></i> JUGAR
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-4">
            <div class="card border-0 shadow-sm h-100 opacity-50">
                <div class="card-body p-5 text-center bg-light">
                    <i class="bi bi-eye display-4 text-secondary opacity-50 mb-3"></i>
                    <h5 class="fw-bold">Próximamente</h5>
                    <button class="btn btn-sm btn-outline-dark mt-3" disabled>En desarrollo</button>
                </div>
            </div>
        </div>
    </div>

    <div id="lista-juegos-lenguaje" class="row d-none">
        
        <div class="col-md-4 mb-4">
            <div class="card border-0 shadow-sm h-100 transform-hover">
                <div class="card-body p-4 text-center bg-white rounded border-top border-5 border-success">
                    <div class="mb-3">
                        <i class="bi bi-cpu-fill display-4 text-success"></i>
                    </div>
                    <h5 class="fw-bold">Juego 1: Memoria</h5>
                    <p class="text-muted small">Versión Web (Antigua)</p>
                    
                    <a href="{% url 'jugar_moca_5' %}" class="btn btn-outline-success rounded-pill px-4 w-100 mt-2">
                        <i class="bi bi-play-fill me-2"></i> JUGAR
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-4">
            <div class="card border-0 shadow-sm h-100 transform-hover">
                <div class="card-body p-4 text-center bg-white rounded border-top border-5 border-primary">
                    <div class="mb-3">
                        <i class="bi bi-joystick display-4 text-primary"></i>
                    </div>
                    <h5 class="fw-bold">Juego 2: Memoria MoCA</h5>
                    <p class="text-muted small">Versión Definitiva Unity</p>
                    
                    <a href="{% url 'jugar_moca_5_definitivo' %}" class="btn btn-primary rounded-pill px-4 w-100 mt-2 shadow">
                        <i class="bi bi-rocket-takeoff-fill me-2"></i> JUGAR AHORA
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-4">
            <div class="card border-0 shadow-sm h-100 transform-hover">
                <div class="card-body p-4 text-center bg-white rounded border-top border-5 border-info">
                    <div class="mb-3">
                        <i class="bi bi-snow2 display-4 text-info"></i>
                    </div>
                    <h5 class="fw-bold">Juego 3: Elsa</h5>
                    <p class="text-muted small">Ejercicio Cognitivo</p>
                    
                    <a href="{% url 'jugar_elsa' %}" class="btn btn-info text-white rounded-pill px-4 w-100 mt-2 shadow-sm">
                        <i class="bi bi-play-fill me-2"></i> JUGAR
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-4">
            <div class="card border-0 shadow-sm h-100 transform-hover">
                <div class="card-body p-4 text-center bg-white rounded border-top border-5 border-warning">
                    <div class="mb-3">
                        <i class="bi bi-calculator-fill display-4 text-warning"></i>
                    </div>
                    <h5 class="fw-bold">Juego 4: Calculadora</h5>
                    <p class="text-muted small">Cálculo y Agilidad Mental</p>
                    
                    <a href="{% url 'jugar_calculadora' %}" class="btn btn-warning text-dark rounded-pill px-4 w-100 mt-2 shadow-sm">
                        <i class="bi bi-play-circle-fill me-2"></i> JUGAR
                    </a>
                </div>
            </div>
        </div>

    </div>
</div>

<style>
    .cursor-pointer { cursor: pointer; }
    .hover-elevate:hover { transform: translateY(-5px); transition: 0.3s; cursor: pointer; background-color: #f8f9fa; }
</style>

<script>
    // Variables de las pantallas
    const pInicio = document.getElementById('pantalla-inicio');
    const pCategorias = document.getElementById('pantalla-categorias');
    const pJuegos = document.getElementById('pantalla-lista-juegos');
    const btnVolver = document.getElementById('btn-volver');
    const titulo = document.getElementById('titulo-seccion');

    // Contenedores de listas
    const listaComun = document.getElementById('lista-juegos-comunes');     // Para Motor
    const listaLenguaje = document.getElementById('lista-juegos-lenguaje'); // Para Lenguaje
    const listaAtencion = document.getElementById('lista-juegos-atencion'); // Para Atención (NUEVO)
    
    let estado = 'inicio'; 

    function mostrarCategorias() {
        pInicio.classList.add('d-none');
        pCategorias.classList.remove('d-none');
        pJuegos.classList.add('d-none');
        
        titulo.innerText = "Selecciona un Área";
        btnVolver.classList.remove('d-none');
        estado = 'categorias';
    }

    function mostrarJuegos(categoria) {
        pInicio.classList.add('d-none');
        pCategorias.classList.add('d-none');
        pJuegos.classList.remove('d-none');

        // Actualizamos textos
        titulo.innerText = "Área de " + categoria;
        document.getElementById('nombre-categoria').innerText = categoria;
        
        // 1. OCULTAR TODO PRIMERO
        listaComun.classList.add('d-none');
        listaLenguaje.classList.add('d-none');
        listaAtencion.classList.add('d-none');

        // 2. MOSTRAR SEGÚN LA CATEGORÍA ELEGIDA
        if (categoria === 'Lenguaje') {
            listaLenguaje.classList.remove('d-none');
        } 
        else if (categoria === 'Atención') {
            listaAtencion.classList.remove('d-none');
        } 
        else {
            // Para Motor u otros, mostramos la lista genérica
            listaComun.classList.remove('d-none');
            
            // Actualizamos títulos dinámicos solo para la lista común
            let titulosJuegos = document.querySelectorAll('.nombre-cat-dinamico');
            titulosJuegos.forEach(el => el.innerText = categoria);
        }

        estado = 'juegos';
    }

    function irAtras() {
        if (estado === 'juegos') {
            mostrarCategorias();
        } else if (estado === 'categorias') {
            pInicio.classList.remove('d-none');
            pCategorias.classList.add('d-none');
            pJuegos.classList.add('d-none');
            titulo.innerText = "Sala de Terapia";
            btnVolver.classList.add('d-none');
            estado = 'inicio';
        }
    }
</script>

{% endblock %}